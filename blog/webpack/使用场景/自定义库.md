# create-own-library 创建自己的库

如果利用 webpack 来创建自己的库提高开发效率，或者服务社区用户，那该很 cool 吧~

这里就简单学习一下官方的样例，学会之后就可以开发自己的库了，比如一个 UI 库（vue3 正式发布了，各大 ui 框架应该都在火热 🔥 升级中，不妨用 vue3 来开发一下呢）

首先梳理一下大致流程：

1. 基本配置，入口文件、出口文件
2. 配置库名，以及将这个库暴露给一个变量
3. 排除不必要的外部依赖
4. 能够访问其他 library
5. 能够通过`es6 import` `commonjs` 全局变量等方式引入

好的 我们逐步开始

首先进行简单的配置

```js
const path = require('path');

module.exports = {
	entry: './src/index.js',
	output: {
		path: path.resolve(__dirname, 'dist'),
		filename: 'webpack-numbers.js'
	}
};
```

配置好 sourcemap，便于调试（能帮助我们查看压缩后的代码对应的源码）

### 外部化依赖配置

正常的 external 可以查看`基本配置`中的`external`文件，

还有一种情况是引用了某一个依赖下的多个文件，我们怎么处理

比如：

```js
import A from 'library/a';
import B from 'library/b';
```

我们可以通过正则表达式来确定

```js
module.exports = {
	//...
	externals: [
		'library/one',
		'library/two',
		// 匹配以 "library/" 开始的所有依赖
		/^library\/.+$/
	]
};
```

### 暴露 library

为了让你的 library 能够在各种使用环境中可用，这里我们需要在 output 中添加属性`library`，

```js
output: {
      path: path.resolve(__dirname, 'dist'),
      filename: 'webpack-numbers.js',
     library: 'webpackNumbers',
    },
```

这会将你的 library bundle 暴露为名为 webpackNumbers 的全局变量，用户 通过此名称来 import
为了让 library 和其他环境兼容，则需要在配置中添加 libraryTarget 属性。这个选项可以控制以多种形式暴露 library。

```js
output: {
      path: path.resolve(__dirname, 'dist'),
      filename: 'webpack-numbers.js',
      library: 'webpackNumbers',
     libraryTarget: 'umd',
    },
```


